<html>
    <head>
        <script>
            var sid = "", web_socket_url = 'ws://localhost:8001', server_url = 'http://localhost:3000'

            function get_sid()
            {
                var action = "signin", login = "user_a", password = "password";
                var xmlhttp = new XMLHttpRequest();
                xmlhttp.open('POST', server_url, true);
                xmlhttp.setRequestHeader('Content-Type', 'application/json; charset=utf-8');
                arr = {"action": action, "params": {"login": login, "password": password}}
                xmlhttp.send(JSON.stringify(arr));
                xmlhttp.onreadystatechange = function() {
                    if (xmlhttp.readyState == 4)
                        if(xmlhttp.status == 200)
                           sid = JSON.parse(xmlhttp.responseText)['sid'];
                };
            }
            get_sid();

            var webSocket = new WebSocket(web_socket_url);
 
            webSocket.onopen = function(event) {
                console.log('onopen');
                webSocket.send(JSON.stringify({"action": "move", "params": {"sid": sid, "dx": 1, "dy": 0}}));
            };
 
            webSocket.onmessage = function(event) {
                console.log('onmessage, ' + event.data);
            };
 
            webSocket.onclose = function(event) {
                console.log('onclose');
            };

        </script>
    </head>
    <body>
    <button onclick='webSocket.send(JSON.stringify({"action": "move", "params": {"sid": sid, "dx": 1, "dy": 0}}))'>move</button>
    </body>
</html>